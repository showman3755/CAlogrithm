#include <stdio.h>
#include "repeat.h"

int array[620] = {1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,4,5,6,7,8,9,10,11,12,101,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,
                  53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,1,2,
				  3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,
				  53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,1,2,
                  3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,
				  53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,1,2,
                  3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,
                  53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,1,2,
				  3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,
				  53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,1,2,
                  3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,
				  53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,1,1,1,2,2,2,2,3};

int ReapeatFunction(int* address, int number)
{
	int i;
	int j;
	static int buffer1[100];         //参考数组
	static int buffer2[100];         //对比数组
	char result = 0;                 //函数返回值，1表示有重复数据出现，0表示没有重复数据出现
	int calcularte = 0;
	static int numPoint = 0;         //address数组的下标，即总采样数据的数组下标
	static int getPoint1 = 0;		 //buffer1数组采集的采集下标
	static int getPoint2 = 0;        //buffer2数组采集的采集下标
	static int sameFlag = 0;         //是否重复标记量，0表示没有重复，1表示有数据重复
	static int circleNum = 0;        //记录圈数

	//存取参考数组
	if (numPoint < number)             
	{
		buffer1[getPoint1] = address[numPoint];
		getPoint1++;
	}


	//存取对比数组
	if (numPoint >= number)           
	{
		if (getPoint2 >= number)
		{
			for (i = 0; i < number; i++)
			{
				buffer2[i] = buffer2[i + 1];      //数组左移一位，删除最开始的元素
			}
			getPoint2 = number;
		}
		buffer2[getPoint2] = address[numPoint];
		getPoint2++;
	}
	
	numPoint++;
	
	//buffer1与buffer2进行一一比较
	for (i = 0; i < number; i++)                    
	{
		if (buffer1[i] == buffer2[i])
		{
			calcularte++;
			if (calcularte == number)              //表明buffer1与buffer2数组刚好完全一一对应相等                  
			{
				printf("发现重复的数据:");
				for (j = 0; j < NUMBER; j++)          //打印重复的数据
				{
					printf("%d", buffer1[j]);
				}
				printf("\r\n");
				sameFlag = 1;
				result = 1;
			}
		}
	}

	if ((address[numPoint + 1] < address[numPoint]) && (sameFlag == 0))        //一圈到了，并且还没有重复数据
	{
		getPoint1 = 0;
		circleNum++;
	}
	if ((circleNum == 4) && (sameFlag == 0))
	{
		//重新存取采样数组
		buffer1[getPoint1] = address[numPoint];
		getPoint1++;
	}

	return result;
}
